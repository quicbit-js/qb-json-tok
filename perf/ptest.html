<html>
<head>
    <title>qb-json-tok Performance Test</title>
</head>
<body>
<H1>Instructions</H1>
<ol>
    <li>build ptest-bundle.js with 'npm run ptest'</li>
    <li>open in browser and view console output to see results</li>
</ol>
<script src="ptest-bundle.js"></script>
<script>
    var sample = '在嚴寒的冬日裡，只要一碗熱湯，暖身又暖心。這道海鮮疙瘩湯用材簡單，'
//    var sample = 'abcd'
    var sample = 'abcdefghijklmnopqrstuvwxyz1234567890'

    var time_tokenize = window.document.ptest.time_tokenize;

    [100, 1000, 10 * 1000, 100 * 1000, 1000 * 1000].forEach(function(n) {
        time_tokenize(sample, n, 100000000)
    });

</script>
</body>
</html>

<!--

macbook pro mid-2014

CHROME 56.0.2924.87 (64-bit) - small strings 'abcd'

buf size: 98
1000000 "keys" 17000000 "vals"
tokenize: 0.1kb buffers 1000000 times in 433.725 ms.  230.56083924145483 mb per sec.
buf size: 1000
100000 "keys" 14600000 "vals"
tokenize: 1kb buffers 100000 times in 496.44 ms.  201.43421158649585 mb per sec.
buf size: 10000
10000 "keys" 14320000 "vals"
tokenize: 10kb buffers 10000 times in 480.3900000000001 ms.  208.16419992089754 mb per sec.
buf size: 100000
1000 "keys" 14289000 "vals"
tokenize: 100kb buffers 1000 times in 518.0249999999999 ms.  193.04087640557893 mb per sec.
buf size: 999999
100 "keys" 14286000 "vals"
tokenize: 1000kb buffers 100 times in 505.83000000000015 ms.  197.69487772571807 mb per sec.



CHROME 56.0.2924.87 (64-bit) - big strings 'abcdefghijklmnopqrstuvwxyz1234567890'

buf size: 100
1000000 "keys" 7000000 "vals"
tokenize: 0.1kb buffers 1000000 times in 375.41499999999996 ms.  266.3718817841589 mb per sec.
buf size: 1000
100000 "keys" 3000000 "vals"
tokenize: 1kb buffers 100000 times in 377.755 ms.  264.7218435229183 mb per sec.
buf size: 10000
10000 "keys" 2610000 "vals"
tokenize: 10kb buffers 10000 times in 358.18499999999995 ms.  279.18533718609103 mb per sec.
buf size: 100000
1000 "keys" 2568000 "vals"
tokenize: 100kb buffers 1000 times in 383.5300000000002 ms.  260.73579641749006 mb per sec.
buf size: 1000000
100 "keys" 2564500 "vals"
tokenize: 1000kb buffers 100 times in 364.31500000000005 ms.  274.48773726033784 mb per sec.



CHROME 56.0.2924.87 (64-bit) - chinese strings (even bigger) '在嚴寒的冬日裡，只要一碗熱湯，暖身又暖心。這道海鮮疙瘩湯用材簡單，'
buf size: 100
1000000 "keys" 5000000 "vals"
tokenize: 0.1kb buffers 1000000 times in 340.855 ms.  293.37988294142673 mb per sec.
buf size: 1000
100000 "keys" 1400000 "vals"
tokenize: 1kb buffers 100000 times in 359.03500000000014 ms.  278.5243778461709 mb per sec.
buf size: 10000
10000 "keys" 1020000 "vals"
tokenize: 10kb buffers 10000 times in 321.6149999999998 ms.  310.93077126377835 mb per sec.
buf size: 100000
1000 "keys" 985000 "vals"
tokenize: 100kb buffers 1000 times in 320.385 ms.  312.124475240726 mb per sec.
buf size: 1000000
100 "keys" 980800 "vals"
tokenize: 1000kb buffers 100 times in 323.6400000000001 ms.  308.9852923000864 mb per sec.
-->